<!DOCTYPE html>
<html lang="en">
<%- include('../partials/adminhead'); -%>

    <body>
        <section id="container">
            <%- include('../partials/adminheader'); -%>
                <%- include('../partials/adminleft'); -%>
                    <!--main content start-->
                    <section id="main-content">
                        <section class="wrapper">
                            <div class="clearfix">
                                <div class="table-agile-info">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            CẬP NHẬT SẢN PHẨM
                                        </div>
                                        <form method="POST" action="/admin/sanpham/storeupdate" enctype="multipart/form-data">
                                            <label>Mã sản phẩm</label>
                                            <input type="text" class="form-control" name="masp" value="<%= product.masp %>" readonly/>         
                                            <label>Tên sản phẩm</label>
                                            <input type="text" class="form-control" name="tensp" value="<%= product.tensp %>"
                                                placeholder="Tên sản phẩm"><br>
                                            <label>Giá tiền</label>
                                            <input type="text" class="form-control" name="giatien" value="<%= product.giatien %>"
                                                placeholder="Giá sản phẩm"><br>
                                            <label>Trạng thái</label> <br />
                                            <% if(product.trangthai){ %>
                                                <input name="trangthai" type="radio" value="1" checked="checked">
                                                    Còn Hàng
                                                <input name="trangthai" type="radio" value="0"> Sắp Hết Hàng <br />
                                                    <br />
                                            <% } else { %>        
                                                <input name="trangthai" type="radio" value="1" >
                                                Còn Hàng
                                                <input name="trangthai" type="radio" value="0" checked="checked"> Sắp Hết Hàng <br />
                                                    <br />
                                            <% } %>
                                            
                                            <label><img src="">Hình ảnh</label>
                                            <input value= "client/img/product/<%= product.hinhanh%>" type="file" class="form-control" 
                                            name="hinhanh" onchange="readFileImage(this)">
                                            <br>
                                            <img src="client/img/product/<%= product.hinhanh%>" width="100" height="100" id="imgSanPham"/>
                                            <br/>
                                            <label>Thương hiệu</label>
                                              <select name="id_math" class="form-control">
                                                <option value="0">------Chọn thương hiệu-------</option>
                                                <% for(let i=0; i < thuonghieus.length; i++) {%>
                                                    <option value="<%= thuonghieus[i].math %>" <%= thuonghieus[i].math == product.id_math ? 'selected' : '' %> >
                                                        <%= thuonghieus[i].tenth %>
                                                    </option>
                                                    <% } %>
                                            </select><br>
                                            <label>Mô tả</label><br />
                                            <textarea id="mota" name="mota" rows="4" cols="140"><%= product.mota %></textarea><br /><br />
                                            <label>Loại sản phẩm</label>
                                             <select name="id_maloai" class="form-control">
                                                <option value="-1">------Chọn danh mục-------</option>
                                                <% for(let i=0; i < danhmucs.length; i++) {%>
                                                        <option value="<%= danhmucs[i].maloai %>" <%= danhmucs[i].maloai == product.id_maloai ? 'selected' : '' %> >
                                                            <%= danhmucs[i].tenloai %>
                                                        </option>
                                                 <% } %>
                                            </select><br>
                                            <input type="submit" name="capnhatsanpham" value="Cập nhật sản phẩm"
                                                class="btn btn-primary"><br/>
                                            <br/>
                                            <a href="admin/sanpham">Quay lại?</a>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </section>
                        <%- include('../partials/adminfooter'); -%>
                    </section>
                    <!--main content end-->
        </section>
        <%- include('../partials/adminscript_bottom'); -%>
    </body>

    <script>
        let isImag = '<%= product.hinhanh%>'; 

        if(!isImag){
            $('#imgSanPham').hide();
        }

        function readFileImage(input){
            // Neu co upload file va co file dau tien 
        
            if(input.files && input.files[0]){
                var reader = new FileReader();

                reader.onload = function(e){
                    $('#imgSanPham').show().attr('src', e.target.result);
                }

                reader.readAsDataURL(input.files[0])
            }
        }
    </script>
</html>